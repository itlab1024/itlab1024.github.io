{"title":"spring-authorization-server授权服务器Oauth2.1（新版）","uid":"63b66b84785bad4685f03c761bd73fdb","slug":"新版authorization-server","date":"2022-04-22T09:57:14.000Z","updated":"2022-06-02T08:46:03.038Z","comments":true,"path":"api/articles/新版authorization-server.json","keywords":null,"cover":"https://raw.githubusercontent.com/ITLab1024/picgo-images/main/202204231225734.png","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>说明</p></blockquote>\n<pre><code>spring Security5 时候，不推荐使用spring-security-oauth2。提供了新的方法（https://github.com/spring-projects/spring-authorization-server）\n</code></pre>\n<p>需要注意的是该方式支持的并不是oauth2，而是oauth2.1，什么是oauth2.1呢？推荐查看：<a href=\"https://oauth.net/2.1/%E5%92%8Chttps://aaronparecki.com/2019/12/12/21/its-time-for-oauth-2-dot-1%E3%80%82\">https://oauth.net/2.1/和https://aaronparecki.com/2019/12/12/21/its-time-for-oauth-2-dot-1。</a></p>\n<p>摘取oauth2.net网站上对比oauth2的说明：</p>\n<p>主要区别（以下使用翻译软件翻译，大致意思没错）</p>\n<ul>\n<li>使用授权代码流的所有 OAuth 客户端都需要 PKCE</li>\n<li>必须使用精确的字符串匹配来比较重定向 URI</li>\n<li><code>response_type=token</code>本规范中省略了隐式授权 ( )</li>\n<li>本规范中省略了资源所有者密码凭证授权</li>\n<li>不记名令牌用法省略了在 URI 的查询字符串中使用不记名令牌</li>\n<li>公共客户端的刷新令牌必须受发送方限制或一次性使用</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>官方demo运行</p></blockquote>\n<pre><code>根据https://github.com/spring-projects/spring-authorization-server上说明使用gradle命令运行即可。\n</code></pre>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>拷贝官方代码（基本未做更改），使用postman进行测试。</p></blockquote>\n<pre><code>    代码位置：authorization-server\n</code></pre>\n<p>​\t\t</p>\n<pre class=\"line-numbers language-tex\" data-language=\"tex\"><code class=\"language-tex\">authorization-server\n├── README.md\n├── authorization-server.iml\n├── pom.xml\n└── src\n    ├── main\n    │   ├── java\n    │   │   └── com\n    │   │       └── xpp\n    │   │           └── ssgo\n    │   │               └── as\n    │   │                   ├── AuthorizationServerApplication.java\n    │   │                   ├── config\n    │   │                   │   ├── SecurityConfig.java\n    │   │                   │   └── WebAuthorizationServerConfig.java\n    │   │                   └── jose\n    │   │                       ├── Jwks.java\n    │   │                       └── KeyGeneratorUtils.java\n    │   └── resources\n    │       ├── data.sql\n    │       └── application.yml\n    └── test\n        └── java</code></pre>\n\n\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>测试</p></blockquote>\n<ul>\n<li><p>启动项目</p>\n<p>查看自动创建的表结构：</p>\n<p>浏览器访问：<a href=\"https://localhost:8080/h2-console\">https://localhost:8080/h2-console</a></p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210826135010766.png\" alt=\"image-20210826135010766\"></p>\n<p>点击Connect：</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210826135541371.png\" alt=\"image-20210826135541371\"></p>\n<p>我们看到有五张表创建，打开表会发现数据也被初始化进去了。</p>\n</li>\n<li><p>授权码模式</p>\n<p>请求授权码模式地址：<a href=\"http://localhost:8080/oauth2/authorize?response_type=code&amp;client_id=messaging-client&amp;scope=message.read&amp;redirect_uri=https://baidu.com\">http://localhost:8080/oauth2/authorize?response_type=code&amp;client_id=messaging-client&amp;scope=message.read&amp;redirect_uri=https://baidu.com</a></p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825172558674.png\" alt=\"image-20210825172558674\"></p>\n<p>输入用户名密码(user1, password):</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825172624486.png\" alt=\"image-20210825172624486\"></p>\n<p>勾选授权scope，点击submit consent按钮：</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825172710505.png\" alt=\"image-20210825172710505\"></p>\n<p>拷贝地址栏：<a href=\"https://www.baidu.com/?code=dPEZCnsiz2WPk5mWdnPImxbSQkbwK7-yPKmg56JuR2NHbswtbXWZFjgZr6MEXfIqi8JhRourmlSSYVVfGuCN-46ep8jbQwxHsqrUVeeY-1XRHkpqaQ2UM9-ulbTsU0mg\">https://www.baidu.com/?code=dPEZCnsiz2WPk5mWdnPImxbSQkbwK7-yPKmg56JuR2NHbswtbXWZFjgZr6MEXfIqi8JhRourmlSSYVVfGuCN-46ep8jbQwxHsqrUVeeY-1XRHkpqaQ2UM9-ulbTsU0mg</a></p>\n<p>授权码code&#x3D;<code>dPEZCnsiz2WPk5mWdnPImxbSQkbwK7-yPKmg56JuR2NHbswtbXWZFjgZr6MEXfIqi8JhRourmlSSYVVfGuCN-46ep8jbQwxHsqrUVeeY-1XRHkpqaQ2UM9-ulbTsU0mg</code></p>\n<p>打开postman 通过该code获取access_token:</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825172829461.png\" alt=\"image-20210825172829461\"></p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825172855024.png\" alt=\"image-20210825172855024\"></p>\n<p>点击send，返回：</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825172954849.png\" alt=\"image-20210825172954849\"></p>\n<p>JSON数据如下：</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\">&#123;\n    &quot;access_token&quot;: &quot;eyJraWQiOiI3NzlmYTBkMC1kYmI5LTRkOGMtYTljNy1iMWE3N2U1MjU3ZDMiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ1c2VyMSIsImF1ZCI6Im1lc3NhZ2luZy1jbGllbnQiLCJuYmYiOjE2Mjk4ODM3NTgsInNjb3BlIjpbIm1lc3NhZ2UucmVhZCJdLCJpc3MiOiJodHRwOlwvXC9hdXRoLXNlcnZlcjo5MDAwIiwiZXhwIjoxNjI5ODg0MDU4LCJpYXQiOjE2Mjk4ODM3NTh9.DONZ0BYwqikDpX36yifOraxr6h_AX4uUAbLqnitC1vEaRHIZVuaSXcLesXx2XxIOyfKu-gglMxho83-JnNU60sX9QQVgnzsHQIExFoBtnFIOmj6mrxOcuTLFWEjya1fqN9rRDAHDInNkTpHICdzKWAtnRR_N7Xwt87B7EwcmAaZedLEyRZo6xQWrx_nIDIsdalxDHricniK7lYxMRHBzXIiV7hIFUtjfPCTGGUhuV3Etu5WGJpo9loOGezTydttvcHttlC8A71viDBR8jD0fQ5Z6NZuq1CfK3rBoh1jXmGUp8g8fi7WTeA2zKyLYYYPSot5FiHcecpc9bAPIh8oPEA&quot;,\n    &quot;refresh_token&quot;: &quot;m166TmZ_o8XpP_wunxsjRRHqH5qbyMMVZz6-tRPQe_73DiKKd5ujdA8TdiwPDgxw6bnYE6MjlTcLy7Cc30BDYsZhHwr7PKXqX0QyQCwkiFRIkrmQOmvCAl-GO_R4gwWZ&quot;,\n    &quot;scope&quot;: &quot;message.read&quot;,\n    &quot;token_type&quot;: &quot;Bearer&quot;,\n    &quot;expires_in&quot;: 299\n&#125;</code></pre>\n\n<p>刷新token</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825173244161.png\" alt=\"image-20210825173244161\"></p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825173308149.png\" alt=\"image-20210825173308149\"></p>\n<p>请求后结果：</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825173228047.png\" alt=\"image-20210825173228047\"></p>\n<p>JSON数据是：</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\">&#123;\n    &quot;access_token&quot;: &quot;eyJraWQiOiI3NzlmYTBkMC1kYmI5LTRkOGMtYTljNy1iMWE3N2U1MjU3ZDMiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJ1c2VyMSIsImF1ZCI6Im1lc3NhZ2luZy1jbGllbnQiLCJuYmYiOjE2Mjk4ODM5MzgsInNjb3BlIjpbIm1lc3NhZ2UucmVhZCJdLCJpc3MiOiJodHRwOlwvXC9hdXRoLXNlcnZlcjo5MDAwIiwiZXhwIjoxNjI5ODg0MjM4LCJpYXQiOjE2Mjk4ODM5Mzh9.GoCvmcLHIWYEN7-_jJQw3cOAC1TOH_If6VuxhgzsRIw2jfeJlgdKRxC9a_meRzoZGWcDb95aM_BPEwFgXsOgiXM5u_NTTaB9j6xEOoaTP_KA8V9bbqw63C-_nYlIzRQwYZUy4YHFDA-bOrUGjZxtRbr1WxP27iwiSMnXQ8XOI8P-gN5mr3EW7gxIr7vtoP1duwmqROirUuskw74YAr2l6ZDxdn7AEG17Qqb5gWYU9j61NHuyJGT7Vy1RQJT_G__vsLVaf-1z7CnE1_9IxSRGQf4TlKDG2F2C7TEGqGnNXQa5Sc-CPjh7hNHEirqH0_rBnKFwG9irtbS7eCFLporjkg&quot;,\n    &quot;refresh_token&quot;: &quot;m166TmZ_o8XpP_wunxsjRRHqH5qbyMMVZz6-tRPQe_73DiKKd5ujdA8TdiwPDgxw6bnYE6MjlTcLy7Cc30BDYsZhHwr7PKXqX0QyQCwkiFRIkrmQOmvCAl-GO_R4gwWZ&quot;,\n    &quot;scope&quot;: &quot;message.read&quot;,\n    &quot;token_type&quot;: &quot;Bearer&quot;,\n    &quot;expires_in&quot;: 300\n&#125;</code></pre>\n\n<p>简化模式（response_type&#x3D;token）在oauth2.1被移除.</p>\n</li>\n<li><p>客户端模式：</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825173403173.png\" alt=\"image-20210825173403173\"></p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825173415004.png\" alt=\"image-20210825173415004\"></p>\n<p>返回结果如图：</p>\n<p><img src=\"https://raw.githubusercontent.com/xpp1109/images/main/uPic/image-20210825173435350.png\" alt=\"image-20210825173435350\"></p>\n<p>JSON结果：</p>\n<pre class=\"line-numbers language-json\" data-language=\"json\"><code class=\"language-json\">&#123;\n    &quot;access_token&quot;: &quot;eyJraWQiOiJjOGRhNzAwZC0zNzUyLTQyMTMtOTFmZi1hOTlmMjY5NTU4NTciLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJtZXNzYWdpbmctY2xpZW50IiwiYXVkIjoibWVzc2FnaW5nLWNsaWVudCIsIm5iZiI6MTYyOTg4MzEzNywic2NvcGUiOlsib3BlbmlkIiwibWVzc2FnZS5yZWFkIiwibWVzc2FnZS53cml0ZSJdLCJpc3MiOiJodHRwOlwvXC9hdXRoLXNlcnZlcjo5MDAwIiwiZXhwIjoxNjI5ODgzNDM3LCJpYXQiOjE2Mjk4ODMxMzd9.NvTu-y5AxLXLSSC_FvxgG3ZYCsOdQRBQgay5sZOmgPAPHcNrTeau7RtdQPoYL7rxedbbfgzBzBOQA3wYepMcuWqO7DBc3kB-I6D6c8nImMo24hSVDTXqnGEtyAUWUhiWJPY1IvVmgksZdaemXQUjFQmBM6Lxt32nBVz8Ap7NXb4oqIbr2bkYodvPRLdYY0PeMpPKAqJuKl4nnRzTCGWx9koJ4KGynkCo3KtMjpv3WuarVKpyiUIhTRlOOAI7wrGplFukaKXpNriMMwasFNtcKfSdWQ6iIDtFs1oUOfE7NJ8EY1FkUaZP1brrHzJgrSvaQPATOfNMFWAA7MN6DzUrlQ&quot;,\n    &quot;scope&quot;: &quot;openid message.read message.write&quot;,\n    &quot;token_type&quot;: &quot;Bearer&quot;,\n    &quot;expires_in&quot;: 300\n&#125;</code></pre>\n</li>\n<li><p>密码模式 在oauth2.1被移除。</p>\n<p>之前以为是bug，就给提了issue（<a href=\"https://github.com/spring-projects/spring-authorization-server/issues/419%EF%BC%89%EF%BC%8C%E5%AE%98%E6%96%B9%E5%9B%9E%E5%A4%8D%E4%B8%8D%E6%94%AF%E6%8C%81%E3%80%82\">https://github.com/spring-projects/spring-authorization-server/issues/419），官方回复不支持。</a></p>\n<p>但是有扩展方式。还没弄。具体可看我提出的issue的作者回复。</p>\n</li>\n</ul>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>spring-security-oauth2的实现方式，可查看我之前的笔记</p>\n<p>知乎：<a href=\"https://zhuanlan.zhihu.com/p/403379055\">https://zhuanlan.zhihu.com/p/403379055</a></p>\n<p>github源码：<a href=\"https://github.com/xpp1109/spring-security-lt5-oauth2\">https://github.com/xpp1109/spring-security-lt5-oauth2</a></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>本文内容github地址是：<a href=\"https://github.com/xpp1109/spring-security-gte5-oauth2\">https://github.com/xpp1109/spring-security-gte5-oauth2</a></p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>一键三联，关注、点赞、分享。完结撒花，谢谢！</p></blockquote>\n<hr>\n<p>梦想越是美丽，就越是显得遥不可及。可奇怪的是，一旦你下定了决心，很快地，那些梦想就一一成为了现实！</p>\n<hr>\n","text":" 说明 spring Security5 时候，不推荐使用spring-security-oauth2。提供了新的方法（https://github.com/spring-projects/spring-authorization-server） 需要注意的是该方式支持的并不是o...","link":"","photos":[],"count_time":{"symbolsCount":"5.5k","symbolsTime":"5 mins."},"categories":[{"name":"Java","slug":"Java","count":2,"path":"api/categories/Java.json"},{"name":"Spring Security","slug":"Java/Spring-Security","count":2,"path":"api/categories/Java/Spring-Security.json"},{"name":"Spring Boot","slug":"Java/Spring-Security/Spring-Boot","count":1,"path":"api/categories/Java/Spring-Security/Spring-Boot.json"}],"tags":[{"name":"Spring Security","slug":"Spring-Security","count":1,"path":"api/tags/Spring-Security.json"},{"name":"spring-authorization-server","slug":"spring-authorization-server","count":1,"path":"api/tags/spring-authorization-server.json"},{"name":"Oauth2.1","slug":"Oauth2-1","count":1,"path":"api/tags/Oauth2-1.json"},{"name":"Java","slug":"Java","count":1,"path":"api/tags/Java.json"}],"toc":"","author":{"name":"ITLab","slug":"blog-author","avatar":"https://raw.githubusercontent.com/ITLab1024/picgo-images/main/202204221711395.png","link":"/","description":"梦想越是美丽，就越是显得遥不可及，可奇怪的是，一旦你下定了决心，很快地，那些梦想就一一成为了现实！","socials":{"github":"https://github.com/ITLab1024","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/xpp1109","csdn":"","juejin":"","customs":{"wxgzh":{"icon":"fa fa-wechat","link":"https://raw.githubusercontent.com/ITLab1024/picgo-images/main/202204231828426.jpg"}}}},"mapped":true,"prev_post":{"title":"Zookeeper集群搭建（3.8.0）","uid":"84d66273b8c632d9f270cda34aaa6364","slug":"Zookeeper集群搭建（3-8-0）","date":"2022-04-23T13:01:21.000Z","updated":"2022-06-02T08:46:03.035Z","comments":true,"path":"api/articles/Zookeeper集群搭建（3-8-0）.json","keywords":null,"cover":"https://raw.githubusercontent.com/ITLab1024/picgo-images/main/202204232104060.jpeg","text":"Zookeeper集群搭建（3.8.0）使用vagrant创建三台虚拟机 #新建Vagrantfile Vagrant.configure(&quot;2&quot;) do |config| (1..3).each do |i| config.vm.define &quot;n...","link":"","photos":[],"count_time":{"symbolsCount":"33k","symbolsTime":"30 mins."},"categories":[{"name":"Zookeeper","slug":"Zookeeper","count":1,"path":"api/categories/Zookeeper.json"}],"tags":[{"name":"Zookeeper cluster","slug":"Zookeeper-cluster","count":1,"path":"api/tags/Zookeeper-cluster.json"},{"name":"3.8.0","slug":"3-8-0","count":1,"path":"api/tags/3-8-0.json"}],"author":{"name":"ITLab","slug":"blog-author","avatar":"https://raw.githubusercontent.com/ITLab1024/picgo-images/main/202204221711395.png","link":"/","description":"梦想越是美丽，就越是显得遥不可及，可奇怪的是，一旦你下定了决心，很快地，那些梦想就一一成为了现实！","socials":{"github":"https://github.com/ITLab1024","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"https://www.zhihu.com/people/xpp1109","csdn":"","juejin":"","customs":{"wxgzh":{"icon":"fa fa-wechat","link":"https://raw.githubusercontent.com/ITLab1024/picgo-images/main/202204231828426.jpg"}}}},"feature":false},"next_post":{}}